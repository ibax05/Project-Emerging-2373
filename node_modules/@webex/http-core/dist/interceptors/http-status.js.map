{"version":3,"names":["_httpError","_interopRequireDefault","require","_interceptor","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf2","default","result","NewTarget","constructor","_Reflect$construct","arguments","apply","_possibleConstructorReturn2","Reflect","sham","Proxy","Boolean","prototype","valueOf","call","e","LOCUS_REDIRECT_ERROR","HttpStatusInterceptor","_Interceptor","_inherits2","_super","webex","options","_this","_classCallCheck2","ErrorConstructor","error","HttpError","_defineProperties","_assertThisInitialized2","value","_createClass2","key","onResponse","response","statusCode","_promise","resolve","body","errorCode","reject","select","create","Interceptor","exports"],"sources":["http-status.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport HttpError from '../http-error';\nimport Interceptor from '../lib/interceptor';\n\nconst LOCUS_REDIRECT_ERROR = 2000002;\n\n/**\n * @class\n */\nexport default class HttpStatusInterceptor extends Interceptor {\n  /**\n   * @param {Object} webex\n   * @param {Object} options\n   * @returns {HttpStatusInterceptor}\n   */\n  constructor(webex, options) {\n    super(webex);\n    const ErrorConstructor = (options && (options.error || options.ErrorConstructor)) || HttpError;\n\n    Object.defineProperties(this, {\n      ErrorConstructor: {\n        value: ErrorConstructor,\n      },\n    });\n  }\n\n  /**\n   * @param {Object} options\n   * @returns {HttpStatusInterceptor}\n   */\n  static create(options) {\n    return new HttpStatusInterceptor(this, options);\n  }\n\n  /**\n   * @param {Object} options\n   * @param {HttpResponse} response\n   * @returns {Promise}\n   */\n  onResponse(options, response) {\n    if (response.statusCode) {\n      if (response.statusCode < 400) {\n        return Promise.resolve(response);\n      }\n      // to handle locus redirects\n      if (\n        response.statusCode === 404 &&\n        response.body &&\n        response.body.errorCode === LOCUS_REDIRECT_ERROR\n      ) {\n        return Promise.resolve(response);\n      }\n    }\n\n    // Note: the extra parenthesis below are required to make sure `new` is\n    // applied to the correct method (i.e., the result of `select()`, not\n    // `select()` itself).\n    return Promise.reject(new (this.ErrorConstructor.select(response.statusCode))(response));\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;AAIA,IAAAA,UAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,YAAA,GAAAF,sBAAA,CAAAC,OAAA;AAA6C,SAAAE,aAAAC,OAAA,QAAAC,yBAAA,GAAAC,yBAAA,oBAAAC,qBAAA,QAAAC,KAAA,OAAAC,gBAAA,CAAAC,OAAA,EAAAN,OAAA,GAAAO,MAAA,MAAAN,yBAAA,QAAAO,SAAA,OAAAH,gBAAA,CAAAC,OAAA,QAAAG,WAAA,EAAAF,MAAA,GAAAG,kBAAA,CAAAN,KAAA,EAAAO,SAAA,EAAAH,SAAA,YAAAD,MAAA,GAAAH,KAAA,CAAAQ,KAAA,OAAAD,SAAA,gBAAAE,2BAAA,CAAAP,OAAA,QAAAC,MAAA;AAAA,SAAAL,0BAAA,eAAAY,OAAA,qBAAAJ,kBAAA,oBAAAA,kBAAA,CAAAK,IAAA,2BAAAC,KAAA,oCAAAC,OAAA,CAAAC,SAAA,CAAAC,OAAA,CAAAC,IAAA,CAAAV,kBAAA,CAAAO,OAAA,8CAAAI,CAAA;AAE7C,IAAMC,oBAAoB,GAAG,OAAO;;AAEpC;AACA;AACA;AAFA,IAGqBC,qBAAqB,0BAAAC,YAAA;EAAA,IAAAC,UAAA,CAAAnB,OAAA,EAAAiB,qBAAA,EAAAC,YAAA;EAAA,IAAAE,MAAA,GAAA3B,YAAA,CAAAwB,qBAAA;EACxC;AACF;AACA;AACA;AACA;EACE,SAAAA,sBAAYI,KAAK,EAAEC,OAAO,EAAE;IAAA,IAAAC,KAAA;IAAA,IAAAC,gBAAA,CAAAxB,OAAA,QAAAiB,qBAAA;IAC1BM,KAAA,GAAAH,MAAA,CAAAN,IAAA,OAAMO,KAAK;IACX,IAAMI,gBAAgB,GAAIH,OAAO,KAAKA,OAAO,CAACI,KAAK,IAAIJ,OAAO,CAACG,gBAAgB,CAAC,IAAKE,kBAAS;IAE9F,IAAAC,iBAAA,CAAA5B,OAAA,MAAA6B,uBAAA,CAAA7B,OAAA,EAAAuB,KAAA,GAA8B;MAC5BE,gBAAgB,EAAE;QAChBK,KAAK,EAAEL;MACT;IACF,CAAC,CAAC;IAAC,OAAAF,KAAA;EACL;;EAEA;AACF;AACA;AACA;EAHE,IAAAQ,aAAA,CAAA/B,OAAA,EAAAiB,qBAAA;IAAAe,GAAA;IAAAF,KAAA;IAQA;AACF;AACA;AACA;AACA;IACE,SAAAG,WAAWX,OAAO,EAAEY,QAAQ,EAAE;MAC5B,IAAIA,QAAQ,CAACC,UAAU,EAAE;QACvB,IAAID,QAAQ,CAACC,UAAU,GAAG,GAAG,EAAE;UAC7B,OAAOC,QAAA,CAAApC,OAAA,CAAQqC,OAAO,CAACH,QAAQ,CAAC;QAClC;QACA;QACA,IACEA,QAAQ,CAACC,UAAU,KAAK,GAAG,IAC3BD,QAAQ,CAACI,IAAI,IACbJ,QAAQ,CAACI,IAAI,CAACC,SAAS,KAAKvB,oBAAoB,EAChD;UACA,OAAOoB,QAAA,CAAApC,OAAA,CAAQqC,OAAO,CAACH,QAAQ,CAAC;QAClC;MACF;;MAEA;MACA;MACA;MACA,OAAOE,QAAA,CAAApC,OAAA,CAAQwC,MAAM,CAAC,KAAK,IAAI,CAACf,gBAAgB,CAACgB,MAAM,CAACP,QAAQ,CAACC,UAAU,CAAC,EAAED,QAAQ,CAAC,CAAC;IAC1F;EAAC;IAAAF,GAAA;IAAAF,KAAA,EA5BD,SAAAY,OAAcpB,OAAO,EAAE;MACrB,OAAO,IAAIL,qBAAqB,CAAC,IAAI,EAAEK,OAAO,CAAC;IACjD;EAAC;EAAA,OAAAL,qBAAA;AAAA,EAvBgD0B,oBAAW;AAAAC,OAAA,CAAA5C,OAAA,GAAAiB,qBAAA"}