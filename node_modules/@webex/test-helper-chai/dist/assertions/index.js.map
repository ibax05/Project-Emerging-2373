{"version":3,"names":["checkError","require","file","schemas","primitives","module","exports","registerAssertions","chai","Assertion","addMethod","expectedRejection","errorLike","errMsgMatcher","msg","assert","flag","util","promise","then","_obj","actual","toString","onReject","reason","Error","compatibleInstance","compatibleConstructor","getConstructorName","placeholder","RegExp","compatibleMessage","concat","getMessage","isRejected","to","be","rejectedWith","expectStatusCode","statusCode","assertStatusCode","obj","have","addProperty","blobLike","isBlobLike","bufferLike","isBufferLike","isNotBlobLike","not","isNotBufferLike"],"sources":["index.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\n/* eslint-disable no-invalid-this */\n\nconst checkError = require('check-error');\nconst file = require('@webex/test-helper-file');\n\nconst schemas = require('./schemas');\nconst primitives = require('./primitives');\n\n/**\n * @param {Object} chai\n * @returns {undefined}\n */\nmodule.exports = function registerAssertions(chai) {\n  const {Assertion} = chai;\n\n  // The follow assertion is adapted from chai-as-promised as that library is no\n  // longer compatible with IE 11\n  Assertion.addMethod('rejectedWith', function expectedRejection(errorLike, errMsgMatcher, msg) {\n    const {assert} = chai;\n    const {flag} = chai.util;\n\n    if (msg) {\n      flag(this, 'message', msg);\n    }\n\n    const promise = this.then ? this : this._obj;\n\n    return promise.then(\n      (actual) => {\n        assert(\n          false,\n          'expected #{this} to be rejected but it was fulfilled with #{act}',\n          null,\n          errorLike && errorLike.toString(),\n          actual\n        );\n\n        return actual;\n      },\n      // complexity is result of basic ternaries\n      // eslint-disable-next-line complexity\n      function onReject(reason) {\n        if (errorLike) {\n          if (errorLike instanceof Error) {\n            if (!checkError.compatibleInstance(reason, errorLike)) {\n              this.assert(\n                false,\n                'expected #{this} to be rejected with #{exp} but was rejected with #{act}',\n                null,\n                errorLike.toString(),\n                reason.toString()\n              );\n            }\n          }\n\n          if (!checkError.compatibleConstructor(reason, errorLike)) {\n            this.assert(\n              false,\n              'expected #{this} to be rejected with #{exp} but was rejected with #{act}',\n              null,\n              errorLike instanceof Error\n                ? errorLike.toString()\n                : errorLike && checkError.getConstructorName(errorLike),\n              reason instanceof Error\n                ? reason.toString()\n                : reason && checkError.getConstructorName(reason)\n            );\n          }\n        }\n\n        if (reason && errMsgMatcher) {\n          let placeholder = 'including';\n\n          if (errMsgMatcher instanceof RegExp) {\n            placeholder = 'matching';\n          }\n\n          if (!checkError.compatibleMessage(reason, errMsgMatcher)) {\n            this.assert(\n              false,\n              `expected #{this} to be be rejected with error ${placeholder} #{exp} but got #{act}`,\n              null,\n              errMsgMatcher,\n              checkError.getMessage(reason)\n            );\n          }\n        }\n\n        return reason;\n      }\n    );\n  });\n\n  chai.assert.isRejected = function isRejected(promise, errorLike, errMsgMatcher, msg) {\n    if (typeof errorLike === 'string' || errorLike instanceof RegExp) {\n      errMsgMatcher = errorLike;\n      errorLike = null;\n    }\n\n    return new Assertion(promise, msg, chai.assert.isRejected, true).to.be.rejectedWith(\n      errorLike,\n      errMsgMatcher\n    );\n  };\n\n  /* eslint no-unused-expressions: [0] */\n\n  Assertion.addMethod('statusCode', function expectStatusCode(statusCode) {\n    this.assert(\n      (this._obj.statusCode || this._obj) === statusCode,\n      `expected #{this} to have an HTTP Status Code of ${statusCode}`,\n      `expected #{this} to not have an HTTP Status Code of ${statusCode}`\n    );\n  });\n\n  chai.assert.statusCode = function assertStatusCode(obj, statusCode, msg) {\n    new Assertion(obj, msg).to.have.statusCode(statusCode);\n  };\n\n  Assertion.addProperty('blobLike', function blobLike() {\n    this.assert(\n      file.isBlobLike(this._obj),\n      'expected #{this} to be a Buffer (nodejs) or Blob (browser)',\n      'expected #{this} not to be a Buffer (nodejs) or Blob (browser)'\n    );\n  });\n\n  Assertion.addProperty('bufferLike', function bufferLike() {\n    this.assert(\n      file.isBufferLike(this._obj),\n      'expected #{this} to be a Buffer (nodejs) or ArrayBuffer (browser)',\n      'expected #{this} not to be a Buffer (nodejs) or ArrayBuffer (browser)'\n    );\n  });\n\n  chai.assert.isBlobLike = function isBlobLike(obj, msg) {\n    new Assertion(obj, msg).to.be.blobLike;\n  };\n\n  chai.assert.isNotBlobLike = function isNotBlobLike(obj, msg) {\n    new Assertion(obj, msg).not.to.be.blobLike;\n  };\n\n  chai.assert.isBufferLike = function isBufferLike(obj, msg) {\n    new Assertion(obj, msg).to.be.bufferLike;\n  };\n\n  chai.assert.isNotBufferLike = function isNotBufferLike(obj, msg) {\n    new Assertion(obj, msg).not.to.be.bufferLike;\n  };\n\n  primitives(chai);\n  schemas(chai);\n};\n"],"mappings":"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"}