{"version":3,"names":["_ampersandState","_interopRequireDefault","require","CredentialsConfig","AmpState","extend","extraProperties","props","idbroker","url","process","env","IDBROKER_BASE_URL","identity","IDENTITY_BASE_URL","authorizationString","WEBEX_AUTHORIZATION_STRING","AUTHORIZATION_STRING","authorizeUrl","WEBEX_AUTHORIZE_URL","concat","client_id","WEBEX_CLIENT_ID","COMMON_IDENTITY_CLIENT_ID","CLIENT_ID","client_secret","WEBEX_CLIENT_SECRET","COMMON_IDENTITY_CLIENT_SECRET","CLIENT_SECRET","redirect_uri","WEBEX_REDIRECT_URI","COMMON_IDENTITY_REDIRECT_URI","REDIRECT_URI","scope","WEBEX_SCOPE","WEBEX_SCOPES","COMMON_IDENTITY_SCOPE","SCOPE","cisService","derived","activationUrl","deps","fn","cache","generateOtpUrl","validateOtpUrl","tokenUrl","TOKEN_URL","revokeUrl","REVOKE_URL","logoutUrl","setPasswordUrl","_default","exports","default"],"sources":["credentials-config.js"],"sourcesContent":["import AmpState from 'ampersand-state';\n\n// The credentials config which includes the CI server info and derived\n// URL properties from them for the various CI services.  The URL's\n// will be updated when the CI changes.\nconst CredentialsConfig = AmpState.extend({\n  // we need to allow extra props for dynamic props like jwtRefreshCallback\n  extraProperties: 'allow',\n\n  props: {\n    /**\n     * The idbroker base host name\n     * @returns {object}\n     */\n    idbroker: [\n      'object',\n      false,\n      () => ({\n        url: process.env.IDBROKER_BASE_URL || 'https://idbroker.webex.com',\n      }),\n    ],\n\n    /**\n     * The identity base host name\n     * @returns {object}\n     */\n    identity: [\n      'object',\n      false,\n      () => ({\n        url: process.env.IDENTITY_BASE_URL || 'https://identity.webex.com',\n      }),\n    ],\n\n    /**\n     * This is the authorization url displayed on the\n     * {@link developer portal|https://developer.webex.com}\n     * @type {string}\n     */\n    authorizationString: [\n      'string',\n      false,\n      process.env.WEBEX_AUTHORIZATION_STRING || process.env.AUTHORIZATION_STRING,\n    ],\n\n    /**\n     * Authorization URL which prompts for user's password. Inferred from\n     * {@link config.credentials.authorizationString}. This config value will\n     * be automatically set if `authorizationString` config value is specified.\n     *\n     * @type {string}\n     */\n    authorizeUrl: [\n      'string',\n      false,\n      process.env.WEBEX_AUTHORIZE_URL ||\n        `${process.env.IDBROKER_BASE_URL || 'https://idbroker.webex.com'}/idb/oauth2/v1/authorize`,\n    ],\n\n    /**\n     * {@see https://tools.ietf.org/html/rfc6749#section-4.1.4}\n     * @type {string}\n     */\n    client_id: [\n      'string',\n      false,\n      process.env.WEBEX_CLIENT_ID || process.env.COMMON_IDENTITY_CLIENT_ID || process.env.CLIENT_ID,\n    ],\n\n    /**\n     * {@see https://tools.ietf.org/html/rfc6749#section-4.1.4}\n     * @type {string}\n     */\n    client_secret: [\n      'string',\n      false,\n      process.env.WEBEX_CLIENT_SECRET ||\n        process.env.COMMON_IDENTITY_CLIENT_SECRET ||\n        process.env.CLIENT_SECRET,\n    ],\n\n    /**\n     * {@see https://tools.ietf.org/html/rfc6749#section-4.1.4}\n     * @type {string}\n     */\n    redirect_uri: [\n      'string',\n      false,\n      process.env.WEBEX_REDIRECT_URI ||\n        process.env.COMMON_IDENTITY_REDIRECT_URI ||\n        process.env.REDIRECT_URI,\n    ],\n\n    /**\n     * {@see https://tools.ietf.org/html/rfc6749#section-4.1.4}\n     * @type {string}\n     */\n    scope: [\n      'string',\n      false,\n      process.env.WEBEX_SCOPE ||\n        process.env.WEBEX_SCOPES ||\n        process.env.COMMON_IDENTITY_SCOPE ||\n        process.env.SCOPE,\n    ],\n\n    /**\n     * Controls the UI of the CI login page.\n     * @private\n     * @type {string}\n     */\n    cisService: ['string', false, 'webex'],\n  },\n\n  derived: {\n    /**\n     * User activation URL\n     * {@link config.credentials.activationUrl}\n     * @type {string}\n     */\n    activationUrl: {\n      deps: ['idbroker.url'],\n      fn() {\n        return `${\n          this.idbroker.url || 'https://idbroker.webex.com'\n        }/idb/token/v1/actions/UserActivation/invoke`;\n      },\n      cache: false,\n    },\n\n    /**\n     * Generate OTP URL\n     * {@link config.credentials.generateOtpUrl}\n     * @type {string}\n     */\n    generateOtpUrl: {\n      deps: ['idbroker.url'],\n      fn() {\n        return `${\n          this.idbroker.url || 'https://idbroker.webex.com'\n        }/idb/token/v1/actions/UserOTP/Generate/invoke`;\n      },\n      cache: false,\n    },\n\n    /**\n     * Validate OTP URL\n     * {@link config.credentials.validateOtpUrl}\n     * @type {string}\n     */\n    validateOtpUrl: {\n      deps: ['idbroker.url'],\n      fn() {\n        return `${\n          this.idbroker.url || 'https://idbroker.webex.com'\n        }/idb/token/v1/actions/UserOTP/Validate/invoke`;\n      },\n      cache: false,\n    },\n\n    // TODO does hydra also have an access_token endpoint?\n    /**\n     * Token URL used for token refresh and auth code exchange\n     * @type {string}\n     */\n    tokenUrl: {\n      deps: ['idbroker.url'],\n      fn() {\n        return process.env.TOKEN_URL || `${this.idbroker.url}/idb/oauth2/v1/access_token`;\n      },\n      cache: false,\n    },\n\n    /**\n     * URL to revoke token\n     * @type {string}\n     */\n    revokeUrl: {\n      deps: ['idbroker.url'],\n      fn() {\n        return process.env.REVOKE_URL || `${this.idbroker.url}/idb/oauth2/v1/revoke`;\n      },\n      cache: false,\n    },\n\n    /**\n     * URL to load when the app logs out\n     * @type {string}\n     */\n    logoutUrl: {\n      deps: ['idbroker.url'],\n      fn() {\n        return `${this.idbroker.url}/idb/oauth2/v1/logout`;\n      },\n      cache: false,\n    },\n\n    /**\n     * Set password URL\n     * @type {string}\n     */\n    setPasswordUrl: {\n      deps: ['identity.url'],\n      fn() {\n        return `${this.identity.url || 'https://identity.webex.com'}/identity/scim/v1/Users`;\n      },\n      cache: false,\n    },\n  },\n});\n\nexport default CredentialsConfig;\n"],"mappings":"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"}