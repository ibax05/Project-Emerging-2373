{"version":3,"names":["_httpCore","require","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf2","default","result","NewTarget","constructor","_Reflect$construct","arguments","apply","_possibleConstructorReturn2","Reflect","sham","Proxy","Boolean","prototype","valueOf","call","e","EmbargoInterceptor","_Interceptor","_inherits2","_super","_classCallCheck2","_createClass2","key","value","onResponseError","options","reason","statusCode","device","webex","internal","loggerMessage","join","clear","credentials","logger","info","_promise","reject","create","Interceptor","exports"],"sources":["embargo.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {Interceptor} from '@webex/http-core';\n\n/**\n * @class\n */\nexport default class EmbargoInterceptor extends Interceptor {\n  /**\n   * @returns {EmbargoInterceptor}\n   */\n  static create() {\n    /* eslint no-invalid-this: [0] */\n    return new EmbargoInterceptor({webex: this});\n  }\n\n  /**\n   * @see Interceptor#onResponseError\n   * @param {Object} options\n   * @param {Error} reason\n   * @returns {Promise}\n   */\n  onResponseError(options, reason) {\n    if (reason.statusCode === 451) {\n      const {device} = this.webex.internal;\n      const loggerMessage = [\n        'Received `HTTP 451 Unavailable For Legal Reasons`, ',\n        'discarding credentials and device registration',\n      ].join('');\n\n      if (device) {\n        this.webex.internal.device.clear();\n      }\n\n      this.webex.credentials.clear();\n      this.webex.logger.info(loggerMessage);\n    }\n\n    return Promise.reject(reason);\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;AAIA,IAAAA,SAAA,GAAAC,OAAA;AAA6C,SAAAC,aAAAC,OAAA,QAAAC,yBAAA,GAAAC,yBAAA,oBAAAC,qBAAA,QAAAC,KAAA,OAAAC,gBAAA,CAAAC,OAAA,EAAAN,OAAA,GAAAO,MAAA,MAAAN,yBAAA,QAAAO,SAAA,OAAAH,gBAAA,CAAAC,OAAA,QAAAG,WAAA,EAAAF,MAAA,GAAAG,kBAAA,CAAAN,KAAA,EAAAO,SAAA,EAAAH,SAAA,YAAAD,MAAA,GAAAH,KAAA,CAAAQ,KAAA,OAAAD,SAAA,gBAAAE,2BAAA,CAAAP,OAAA,QAAAC,MAAA;AAAA,SAAAL,0BAAA,eAAAY,OAAA,qBAAAJ,kBAAA,oBAAAA,kBAAA,CAAAK,IAAA,2BAAAC,KAAA,oCAAAC,OAAA,CAAAC,SAAA,CAAAC,OAAA,CAAAC,IAAA,CAAAV,kBAAA,CAAAO,OAAA,8CAAAI,CAAA;AAE7C;AACA;AACA;AAFA,IAGqBC,kBAAkB,0BAAAC,YAAA;EAAA,IAAAC,UAAA,CAAAlB,OAAA,EAAAgB,kBAAA,EAAAC,YAAA;EAAA,IAAAE,MAAA,GAAA1B,YAAA,CAAAuB,kBAAA;EAAA,SAAAA,mBAAA;IAAA,IAAAI,gBAAA,CAAApB,OAAA,QAAAgB,kBAAA;IAAA,OAAAG,MAAA,CAAAb,KAAA,OAAAD,SAAA;EAAA;EAAA,IAAAgB,aAAA,CAAArB,OAAA,EAAAgB,kBAAA;IAAAM,GAAA;IAAAC,KAAA;IASrC;AACF;AACA;AACA;AACA;AACA;IACE,SAAAC,gBAAgBC,OAAO,EAAEC,MAAM,EAAE;MAC/B,IAAIA,MAAM,CAACC,UAAU,KAAK,GAAG,EAAE;QAC7B,IAAOC,MAAM,GAAI,IAAI,CAACC,KAAK,CAACC,QAAQ,CAA7BF,MAAM;QACb,IAAMG,aAAa,GAAG,CACpB,qDAAqD,EACrD,gDAAgD,CACjD,CAACC,IAAI,CAAC,EAAE,CAAC;QAEV,IAAIJ,MAAM,EAAE;UACV,IAAI,CAACC,KAAK,CAACC,QAAQ,CAACF,MAAM,CAACK,KAAK,EAAE;QACpC;QAEA,IAAI,CAACJ,KAAK,CAACK,WAAW,CAACD,KAAK,EAAE;QAC9B,IAAI,CAACJ,KAAK,CAACM,MAAM,CAACC,IAAI,CAACL,aAAa,CAAC;MACvC;MAEA,OAAOM,QAAA,CAAArC,OAAA,CAAQsC,MAAM,CAACZ,MAAM,CAAC;IAC/B;EAAC;IAAAJ,GAAA;IAAAC,KAAA;IA/BD;AACF;AACA;IACE,SAAAgB,OAAA,EAAgB;MACd;MACA,OAAO,IAAIvB,kBAAkB,CAAC;QAACa,KAAK,EAAE;MAAI,CAAC,CAAC;IAC9C;EAAC;EAAA,OAAAb,kBAAA;AAAA,EAP6CwB,qBAAW;AAAAC,OAAA,CAAAzC,OAAA,GAAAgB,kBAAA"}