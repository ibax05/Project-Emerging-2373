{"version":3,"names":["_httpCore","require","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf2","default","result","NewTarget","constructor","_Reflect$construct","arguments","apply","_possibleConstructorReturn2","Reflect","sham","Proxy","Boolean","prototype","valueOf","call","e","RequestEventInterceptor","_Interceptor","_inherits2","_super","_classCallCheck2","_createClass2","key","value","onRequest","options","logger","_get2","console","webex","trigger","error","warn","_promise","resolve","onRequestError","reason","reject","onResponse","response","onResponseError","create","Interceptor","exports"],"sources":["request-event.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {get} from 'lodash';\nimport {Interceptor} from '@webex/http-core';\n\n/**\n * @class\n */\nexport default class RequestEventInterceptor extends Interceptor {\n  /**\n   * @returns {RequestEventInterceptor}\n   */\n  static create() {\n    return new RequestEventInterceptor({webex: this});\n  }\n\n  /**\n   * @see Interceptor#onRequest\n   * @param {Object} options\n   * @returns {Object}\n   */\n  onRequest(options) {\n    const logger = get(this, 'webex.logger', console);\n\n    try {\n      this.webex.trigger('request:start', options);\n    } catch (error) {\n      logger.warn('event handler for request:start failed ', error);\n    }\n\n    return Promise.resolve(options);\n  }\n\n  /**\n   * @see Interceptor#onRequest\n   * @param {Object} options\n   * @param {Error} reason\n   * @returns {Object}\n   */\n  onRequestError(options, reason) {\n    // We need to do the normal onRequest logging, but then log how the request\n    // failed since the response logger won't be called.\n    const logger = get(this, 'webex.logger', console);\n\n    try {\n      this.webex.trigger('request:end', options, reason);\n      this.webex.trigger('request:failure', options, reason);\n    } catch (error) {\n      logger.warn('event handler for request:end failed ', error);\n    }\n\n    return Promise.reject(reason);\n  }\n\n  /**\n   * @see Interceptor#onResponse\n   * @param {Object} options\n   * @param {HttpResponse} response\n   * @returns {Object}\n   */\n  onResponse(options, response) {\n    const logger = get(this, 'webex.logger', console);\n\n    try {\n      this.webex.trigger('request:success', response.options, response);\n    } catch (error) {\n      logger.warn('event handler for request:success failed ', error);\n    }\n\n    return Promise.resolve(response);\n  }\n\n  /**\n   * @see Interceptor#onResponseError\n   * @param {Object} options\n   * @param {Error} reason\n   * @returns {Object}\n   */\n  onResponseError(options, reason) {\n    const logger = get(this, 'webex.logger', console);\n\n    try {\n      this.webex.trigger('request:end', options, reason);\n      this.webex.trigger('request:failure', options, reason);\n    } catch (error) {\n      logger.warn('event handler for request:failure failed ', error);\n    }\n\n    return Promise.reject(reason);\n  }\n}\n"],"mappings":"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"}