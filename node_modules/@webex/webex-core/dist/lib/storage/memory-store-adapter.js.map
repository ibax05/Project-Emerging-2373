{"version":3,"names":["_errors","require","_bind","namespace","options","arguments","length","undefined","_promise","default","reject","Error","logger","_options","map","_map","data","_keys","forEach","key","set","debug","resolve","clear","del","concat","delete","get","res","NotFoundError","put","value","_default","bind","preload","exports"],"sources":["memory-store-adapter.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {NotFoundError} from './errors';\n\n/**\n * Binds a namespace\n * @param {string} namespace\n * @param {Object} options\n * @param {Object} options.data\n * @private\n * @returns {Promise<Object>}\n */\nfunction _bind(namespace, options = {}) {\n  options = options || {};\n  if (!namespace) {\n    return Promise.reject(new Error('`namespace` is required'));\n  }\n\n  if (!options.logger) {\n    return Promise.reject(new Error('`options.logger` is required'));\n  }\n\n  const {logger} = options;\n\n  const map = new Map([['@', {}]]);\n\n  if (options.data) {\n    Object.keys(options.data).forEach((key) => {\n      map.set(key, options.data[key]);\n    });\n  }\n\n  logger.debug('memory-store-adapter: returning binding');\n\n  return Promise.resolve({\n    clear() {\n      logger.debug('memory-store-adapter: clearing the binding');\n\n      return Promise.resolve(map.clear());\n    },\n    del(key) {\n      logger.debug(`memory-store-adapter: deleting \\`${key}\\``);\n\n      return Promise.resolve(map.delete(key));\n    },\n    get(key) {\n      logger.debug(`memory-store-adapter: reading \\`${key}\\``);\n      const res = map.get(key);\n\n      if (typeof res === 'undefined') {\n        return Promise.reject(new NotFoundError());\n      }\n\n      return Promise.resolve(res);\n    },\n    put(key, value) {\n      logger.debug(`memory-store-adapter: writing \\`${key}\\``);\n\n      return Promise.resolve(map.set(key, value));\n    },\n  });\n}\n\nexport default {\n  bind: _bind,\n  preload(data) {\n    return {\n      bind(namespace, options = {}) {\n        if (data[namespace]) {\n          options.data = data[namespace];\n        }\n\n        return _bind(namespace, options);\n      },\n    };\n  },\n};\n"],"mappings":"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"}