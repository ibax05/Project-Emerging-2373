{"version":3,"names":["_constants","require","_parameter","_interopRequireDefault","SelfUtils","PSTN_DEVICE_TYPE","parse","self","deviceId","_joinedWith$intent","joinedWith","devices","find","device","url","pstnDevices","filter","deviceType","remoteMuted","getRemoteMuted","unmuteAllowed","getUnmuteAllowed","localAudioUnmuteRequested","getLocalAudioUnmuteRequested","localAudioUnmuteRequired","getLocalAudioUnmuteRequired","lastModified","getLastModified","modifiedBy","getModifiedBy","guest","moderator","mediaStatus","getStatus","status","state","currentMediaStatus","getMediaStatus","mediaSessions","creator","isCreator","selfId","id","selfIdentity","getSelfIdentity","selfUrl","removed","roles","getRoles","isUserUnadmitted","_IDLE_","intent","type","_WAIT_","layout","getLayout","canNotViewTheParticipantList","isSharingBlocked","_self$controls","_isArray","default","controls","layouts","undefined","_self$controls2","_self$controls2$role","role","reduce","hasRole","push","getSelves","oldSelf","newSelf","previous","current","updates","isUserAdmitted","isMutedByOthersChanged","mutedByOthersChanged","localAudioUnmuteRequestedByServer","localAudioUnmuteRequiredByServer","moderatorChanged","isMediaInactiveOrReleased","wasMediaInactiveOrReleased","isUserObserving","isDeviceObserving","layoutChanged","isMediaInactive","audioStateChange","audio","videoStateChange","video","shareStateChange","share","canNotViewTheParticipantListChanged","isSharingBlockedChanged","isJoined","_JOINED_","previousMediaStatus","MEDIA_STATE","inactive","direction","meta","person","muted","_self$controls3","_self$controls3$audio","requestedToUnmute","disallowUnmute","_self$controls4","_self$controls4$audio","audioStatus","videoStatus","slides","videoSlidesStatus","arguments","length","changedSelf","_LEFT_","reason","MEETING_END_REASON","INACTIVE","MEDIA_RELEASED","isLocusUserUnadmitted","check","_check$joinedWith","_check$joinedWith$int","isLocusUserAdmitted","_check$joinedWith2","_check$joinedWith2$in","ParameterError","_oldSelf$joinedWith","_oldSelf$joinedWith$i","_changedSelf$joinedWi","_changedSelf$joinedWi2","_MOVE_MEDIA_","_OBSERVE_","getSipUrl","partner","sipUri","_CALL_","sipUrl","media","mediaType","AUDIO","mediaContent","MediaContent","main","VIDEO","_default","exports"],"sources":["selfUtils.ts"],"sourcesContent":["/* eslint-disable default-param-last */\n\nimport {\n  _IDLE_,\n  _JOINED_,\n  _CALL_,\n  _WAIT_,\n  _MOVE_MEDIA_,\n  _OBSERVE_,\n  _LEFT_,\n  MEETING_END_REASON,\n  MEDIA_STATE,\n  AUDIO,\n  VIDEO,\n  MediaContent,\n} from '../constants';\nimport ParameterError from '../common/errors/parameter';\n\nconst SelfUtils: any = {};\nconst PSTN_DEVICE_TYPE = 'PROVISIONAL';\n\n/**\n * parses the relevant values for self: muted, guest, moderator, mediaStatus, state, joinedWith, pstnDevices, creator, id\n * @param {Object} self\n * @param {String} deviceId\n * @returns {undefined}\n */\nSelfUtils.parse = (self: any, deviceId: string) => {\n  if (self) {\n    const joinedWith = self.devices.find((device) => deviceId === device.url);\n    const pstnDevices = self.devices.filter((device) => PSTN_DEVICE_TYPE === device.deviceType);\n\n    return {\n      remoteMuted: SelfUtils.getRemoteMuted(self),\n      unmuteAllowed: SelfUtils.getUnmuteAllowed(self),\n      localAudioUnmuteRequested: SelfUtils.getLocalAudioUnmuteRequested(self),\n      localAudioUnmuteRequired: SelfUtils.getLocalAudioUnmuteRequired(self),\n      lastModified: SelfUtils.getLastModified(self),\n      modifiedBy: SelfUtils.getModifiedBy(self),\n      guest: self.guest,\n      moderator: self.moderator,\n      // cumulative media stats\n      mediaStatus: SelfUtils.getStatus(self.status),\n      // TODO: what should be the status if user has refreshed the page,\n      // check the joinedWith parameter and communicate to the user\n      state: self.state,\n      // TODO: give a proper name . With same device as login or different login`\n      // Some times we might have joined with both mobile and web\n      joinedWith,\n      pstnDevices,\n      // current media stats is for the current device who has joined\n      currentMediaStatus: SelfUtils.getMediaStatus(joinedWith?.mediaSessions),\n      creator: self.isCreator, // check if its used,\n      selfId: self.id,\n      selfIdentity: SelfUtils.getSelfIdentity(self),\n      selfUrl: self.url,\n      removed: self.removed,\n      roles: SelfUtils.getRoles(self),\n      isUserUnadmitted: self.state === _IDLE_ && joinedWith?.intent?.type === _WAIT_,\n      layout: SelfUtils.getLayout(self),\n      canNotViewTheParticipantList: SelfUtils.canNotViewTheParticipantList(self),\n      isSharingBlocked: SelfUtils.isSharingBlocked(self),\n    };\n  }\n\n  return null;\n};\n\nSelfUtils.getLayout = (self) =>\n  Array.isArray(self?.controls?.layouts) ? self.controls.layouts[0].type : undefined;\n\nSelfUtils.getRoles = (self) =>\n  (self?.controls?.role?.roles || []).reduce((roles, role) => {\n    if (role.hasRole) {\n      roles.push(role.type);\n    }\n\n    return roles;\n  }, []);\n\nSelfUtils.canNotViewTheParticipantList = (self) => !!self?.canNotViewTheParticipantList;\n\nSelfUtils.isSharingBlocked = (self) => !!self?.isSharingBlocked;\n\nSelfUtils.getSelves = (oldSelf, newSelf, deviceId) => {\n  const previous = oldSelf && SelfUtils.parse(oldSelf, deviceId);\n  const current = newSelf && SelfUtils.parse(newSelf, deviceId);\n  const updates: any = {};\n\n  updates.isUserUnadmitted = SelfUtils.isUserUnadmitted(current);\n  updates.isUserAdmitted = SelfUtils.isUserAdmitted(previous, current);\n  updates.isMutedByOthersChanged = SelfUtils.mutedByOthersChanged(previous, current);\n  updates.localAudioUnmuteRequestedByServer = SelfUtils.localAudioUnmuteRequestedByServer(\n    previous,\n    current\n  );\n  updates.localAudioUnmuteRequiredByServer = SelfUtils.localAudioUnmuteRequiredByServer(\n    previous,\n    current\n  );\n  updates.moderatorChanged = SelfUtils.moderatorChanged(previous, current);\n  updates.isMediaInactiveOrReleased = SelfUtils.wasMediaInactiveOrReleased(previous, current);\n  updates.isUserObserving = SelfUtils.isDeviceObserving(previous, current);\n  updates.layoutChanged = SelfUtils.layoutChanged(previous, current);\n\n  updates.isMediaInactive = SelfUtils.isMediaInactive(previous, current);\n  updates.audioStateChange =\n    previous?.currentMediaStatus.audio !== current.currentMediaStatus.audio;\n  updates.videoStateChange =\n    previous?.currentMediaStatus.video !== current.currentMediaStatus.video;\n  updates.shareStateChange =\n    previous?.currentMediaStatus.share !== current.currentMediaStatus.share;\n\n  updates.canNotViewTheParticipantListChanged =\n    previous?.canNotViewTheParticipantList !== current.canNotViewTheParticipantList;\n  updates.isSharingBlockedChanged = previous?.isSharingBlocked !== current.isSharingBlocked;\n\n  return {\n    previous,\n    current,\n    updates,\n  };\n};\n\n/**\n * Checks if user has joined the meeting\n * @param {Object} self\n * @returns {boolean} isJoined\n */\nSelfUtils.isJoined = (self: any) => self?.state === _JOINED_;\n\n/**\n * Validate if the Meeting Layout Controls Layout has changed.\n *\n * @param {Self} previous - Previous self state\n * @param {Self} current - Current self state [per event]\n * @returns {boolean} - If the MEeting Layout Controls Layout has changed.\n */\nSelfUtils.layoutChanged = (previous: any, current: any) =>\n  current?.layout && previous?.layout !== current?.layout;\n\nSelfUtils.isMediaInactive = (previous, current) => {\n  if (\n    previous &&\n    previous.joinedWith &&\n    previous.joinedWith.mediaSessions &&\n    current &&\n    current.joinedWith &&\n    current.joinedWith.mediaSessions\n  ) {\n    const previousMediaStatus = SelfUtils.getMediaStatus(previous.joinedWith.mediaSessions);\n    const currentMediaStatus = SelfUtils.getMediaStatus(current.joinedWith.mediaSessions);\n\n    if (\n      previousMediaStatus.audio &&\n      currentMediaStatus.audio &&\n      previousMediaStatus.audio.state !== MEDIA_STATE.inactive &&\n      currentMediaStatus.audio.state === MEDIA_STATE.inactive &&\n      currentMediaStatus.audio.direction !== MEDIA_STATE.inactive\n    ) {\n      return true;\n    }\n\n    if (\n      previousMediaStatus.video &&\n      currentMediaStatus.video &&\n      previousMediaStatus.video.state !== MEDIA_STATE.inactive &&\n      currentMediaStatus.video.state === MEDIA_STATE.inactive &&\n      currentMediaStatus.video.direction !== MEDIA_STATE.inactive\n    ) {\n      return true;\n    }\n\n    if (\n      previousMediaStatus.share &&\n      currentMediaStatus.share &&\n      previousMediaStatus.share.state !== MEDIA_STATE.inactive &&\n      currentMediaStatus.share.state === MEDIA_STATE.inactive &&\n      currentMediaStatus.share.direction !== MEDIA_STATE.inactive\n    ) {\n      return true;\n    }\n\n    return false;\n  }\n\n  return false;\n};\n\nSelfUtils.getLastModified = (self) => {\n  if (\n    !self ||\n    !self.controls ||\n    !self.controls.audio ||\n    !self.controls.audio.meta ||\n    !self.controls.audio.meta.lastModified\n  ) {\n    return null;\n  }\n\n  return self.controls.audio.meta.lastModified;\n};\n\nSelfUtils.getModifiedBy = (self) => {\n  if (\n    !self ||\n    !self.controls ||\n    !self.controls.audio ||\n    !self.controls.audio.meta ||\n    !self.controls.audio.meta.modifiedBy\n  ) {\n    return null;\n  }\n\n  return self.controls.audio.meta.modifiedBy;\n};\n\n/**\n * get the id from the self object\n * @param {Object} self\n * @returns {String}\n */\nSelfUtils.getSelfIdentity = (self: any) => {\n  if (!self && !self.person) {\n    return null;\n  }\n\n  return self.person.id;\n};\n\n/**\n * get the \"remote mute\" property from the self object\n * @param {Object} self\n * @returns {Boolean}\n */\nSelfUtils.getRemoteMuted = (self: any) => {\n  if (!self || !self.controls || !self.controls.audio) {\n    return null;\n  }\n\n  return self.controls.audio.muted;\n};\n\nSelfUtils.getLocalAudioUnmuteRequested = (self) => !!self?.controls?.audio?.requestedToUnmute;\n\nSelfUtils.getUnmuteAllowed = (self) => {\n  if (!self || !self.controls || !self.controls.audio) {\n    return null;\n  }\n\n  return !self.controls.audio.disallowUnmute;\n};\n\nSelfUtils.getLocalAudioUnmuteRequired = (self) => !!self?.controls?.audio?.localAudioUnmuteRequired;\n\nSelfUtils.getStatus = (status) => ({\n  audio: status.audioStatus,\n  video: status.videoStatus,\n  slides: status.videoSlidesStatus,\n});\n\n/**\n * @param {Object} oldSelf\n * @param {Object} changedSelf\n * @returns {Boolean}\n */\nSelfUtils.wasMediaInactiveOrReleased = (oldSelf: any = {}, changedSelf: any) =>\n  oldSelf.joinedWith &&\n  oldSelf.joinedWith.state === _JOINED_ &&\n  changedSelf.joinedWith &&\n  changedSelf.joinedWith.state === _LEFT_ &&\n  (changedSelf.joinedWith.reason === MEETING_END_REASON.INACTIVE ||\n    changedSelf.joinedWith.reason === MEETING_END_REASON.MEDIA_RELEASED);\n\n/**\n * @param {Object} check\n * @returns {Boolean}\n */\nSelfUtils.isLocusUserUnadmitted = (check: any) =>\n  check && check.joinedWith?.intent?.type === _WAIT_ && check.state === _IDLE_;\n\n/**\n * @param {Object} check\n * @returns {Boolean}\n */\nSelfUtils.isLocusUserAdmitted = (check: any) =>\n  check && check.joinedWith?.intent?.type !== _WAIT_ && check.state === _JOINED_;\n\n/**\n * @param {Object} self\n * @returns {Boolean}\n * @throws {Error} when self is undefined\n */\nSelfUtils.isUserUnadmitted = (self: object) => {\n  if (!self) {\n    throw new ParameterError('self must be defined to determine if self is unadmitted as guest.');\n  }\n\n  return SelfUtils.isLocusUserUnadmitted(self);\n};\n\nSelfUtils.moderatorChanged = (oldSelf, changedSelf) => {\n  if (!oldSelf) {\n    return true;\n  }\n  if (!changedSelf) {\n    throw new ParameterError(\n      'New self must be defined to determine if self transitioned moderator status.'\n    );\n  }\n\n  return oldSelf.moderator !== changedSelf.moderator;\n};\n\n/**\n * @param {Object} oldSelf\n * @param {Object} changedSelf\n * @returns {Boolean}\n * @throws {Error} if changed self was undefined\n */\nSelfUtils.isDeviceObserving = (oldSelf: any, changedSelf: any) =>\n  oldSelf &&\n  oldSelf.joinedWith?.intent?.type === _MOVE_MEDIA_ &&\n  changedSelf &&\n  changedSelf.joinedWith?.intent?.type === _OBSERVE_;\n\n/**\n * @param {Object} oldSelf\n * @param {Object} changedSelf\n * @returns {Boolean}\n * @throws {Error} if changed self was undefined\n */\nSelfUtils.isUserAdmitted = (oldSelf: object, changedSelf: object) => {\n  if (!oldSelf) {\n    // if there was no previous locus, it couldn't have been admitted yet\n    return false;\n  }\n  if (!changedSelf) {\n    throw new ParameterError(\n      'New self must be defined to determine if self transitioned to admitted as guest.'\n    );\n  }\n\n  return SelfUtils.isLocusUserUnadmitted(oldSelf) && SelfUtils.isLocusUserAdmitted(changedSelf);\n};\n\nSelfUtils.mutedByOthersChanged = (oldSelf, changedSelf) => {\n  if (!changedSelf) {\n    throw new ParameterError('New self must be defined to determine if self was muted by others.');\n  }\n\n  if (!oldSelf || oldSelf.remoteMuted === null) {\n    if (changedSelf.remoteMuted) {\n      return true; // this happens when mute on-entry is enabled\n    }\n\n    // we don't want to be sending the 'meeting:self:unmutedByOthers' notification on meeting join\n    return false;\n  }\n\n  return (\n    changedSelf.remoteMuted !== null &&\n    (oldSelf.remoteMuted !== changedSelf.remoteMuted ||\n      (changedSelf.remoteMuted && oldSelf.unmuteAllowed !== changedSelf.unmuteAllowed))\n  );\n};\n\nSelfUtils.localAudioUnmuteRequestedByServer = (oldSelf: any = {}, changedSelf: any) => {\n  if (!changedSelf) {\n    throw new ParameterError(\n      'New self must be defined to determine if self received request to unmute.'\n    );\n  }\n\n  return changedSelf.localAudioUnmuteRequested && !oldSelf.localAudioUnmuteRequested;\n};\n\nSelfUtils.localAudioUnmuteRequiredByServer = (oldSelf: any = {}, changedSelf: any) => {\n  if (!changedSelf) {\n    throw new ParameterError(\n      'New self must be defined to determine if localAudioUnmuteRequired changed.'\n    );\n  }\n\n  return (\n    !changedSelf.remoteMuted &&\n    changedSelf.localAudioUnmuteRequired &&\n    oldSelf.localAudioUnmuteRequired !== changedSelf.localAudioUnmuteRequired\n  );\n};\n\n/**\n * extract the sipUrl from the partner\n * @param {Object} partner\n * @param {Object} info\n * @returns {Object}\n */\n\nSelfUtils.getSipUrl = (partner: any, type, sipUri) => {\n  // For webex meeting the sipUrl gets updated in info parser\n  if (partner && type === _CALL_) {\n    return {sipUri: partner.person.sipUrl || partner.person.id};\n  }\n\n  return {sipUri};\n};\n\nSelfUtils.getMediaStatus = (mediaSessions = []) => {\n  const mediaStatus = {\n    audio: {},\n    video: {},\n    share: {},\n  };\n\n  mediaStatus.audio = mediaSessions.find(\n    (media) => media.mediaType === AUDIO && media.mediaContent === MediaContent.main\n  );\n  mediaStatus.video = mediaSessions.find(\n    (media) => media.mediaType === VIDEO && media.mediaContent === MediaContent.main\n  );\n  mediaStatus.share = mediaSessions.find(\n    (media) => media.mediaType === VIDEO && media.mediaContent === MediaContent.slides\n  );\n\n  return mediaStatus;\n};\n\nexport default SelfUtils;\n"],"mappings":"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"}