{"version":3,"names":["_loggerProxy","_interopRequireDefault","require","_constants","_config","_peerConnectionManager","_reconnection","_media","_browserDetection","ownKeys","object","enumerableOnly","keys","_Object$keys","_Object$getOwnPropertySymbols","symbols","filter","sym","_Object$getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","Object","forEach","key","_defineProperty2","default","_Object$getOwnPropertyDescriptors","_Object$defineProperties","_Object$defineProperty","_BrowserDetection","BrowserDetection","isBrowser","Media","setLocalTrack","enabled","track","reconnectMedia","peerConnection","_ref","meetingId","remoteQualityLevel","enableRtx","enableExtmap","connectionState","PEER_CONNECTION_STATE","CLOSED","FAILED","_promise","reject","ReconnectionError","PeerConnectionManager","createOffer","generateLocalMedias","mediaId","audioMuted","videoMuted","localSdp","_stringify","getLocalMedia","options","config","sendAudio","sendVideo","sendShare","sharePreferences","isSharing","getMedia","getDisplayMedia","resolve","undefined","checkTracks","trackType","receiveTracks","getDirection","sendTracks","direction","attachMedia","mediaProperties","_ref2","mediaDirection","audioTrack","videoTrack","shareTrack","result","receiveAudio","audioTransceiver","addTransceiver","receiveVideo","videoTransceiver","receiveShare","shareTransceiver","onnegotiationneeded","event","LoggerProxy","logger","info","concat","updateMedia","_ref3","setTrackOnTransceiver","type","sendTrack","receiveTrack","transceiver","sender","replaceTrack","e","error","updateTransceiver","_ref4","customResolution","screenResolution","customShareFrameRate","screenFrameRate","hasSharePreferences","hasCustomConstraints","shareConstraints","hasHighFrameRate","highFrameRate","_Config$meetings","Config","meetings","resolution","videoShareFrameRate","aspectRatio","cursor","MEDIA_TRACK_CONSTRAINT","CURSOR","AWLAYS","frameRate","height","idealHeight","width","idealWidth","mediaConfig","audio","video","navigator","mediaDevices","then","stream","getVideoTracks","applyConstraints","getDisplayMediaParams","defaultWidth","ideal","max","maxWidth","defaultHeight","maxHeight","deviceId","facingMode","fake","process","env","NODE_ENV","getUserMedia","catch","err","logPath","constraint","getSupportedDevice","_ref5","enumerateDevices","devices","supported","device","kind","AUDIO_INPUT","VIDEO_INPUT","getDevices","MediaError","toggleStream","stopTracks","stop","readyState","stopStream","warn","getTracks","mediaSetting","audioVideo","localStream","shareStream","_default","exports"],"sources":["index.ts"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n/* globals navigator */\n\nimport LoggerProxy from '../common/logs/logger-proxy';\nimport {\n  AUDIO_INPUT,\n  VIDEO_INPUT,\n  PEER_CONNECTION_STATE,\n  MEDIA_TRACK_CONSTRAINT,\n} from '../constants';\nimport Config from '../config';\nimport PeerConnectionManager from '../peer-connection-manager';\nimport ReconnectionError from '../common/errors/reconnection';\nimport MediaError from '../common/errors/media';\nimport BrowserDetection from '../common/browser-detection';\n\nconst {isBrowser} = BrowserDetection();\n\n/**\n * MediaDirection\n * @typedef {Object} MediaDirection\n * @property {boolean} sendAudio\n * @property {boolean} receiveAudio\n * @property {boolean} sendVideo\n * @property {boolean} receiveVideo\n * @property {boolean} sendShare\n * @property {boolean} receiveShare\n */\n\n/**\n * SendOptions\n * @typedef {Object} SendOptions\n * @property sendAudio\n * @property sendVideo\n * @property sendShare\n * @property isSharing\n * @property {Object} sharePreferences\n */\n/**\n *\n * @public\n * @export\n * Mimic browser APIs as \"the ultimate browser\".\n * Handles the quirks of each browser.\n * Extends and enhances adapter.js, i.e., the \"media\" file from the web client.\n */\nconst Media: any = {};\n\n/**\n * @param {boolean} enabled\n * @param {MediaStreamTrack} track\n * @returns {Boolean}\n * @public\n */\nMedia.setLocalTrack = (enabled: boolean, track: MediaStreamTrack) => {\n  if (track) {\n    track.enabled = enabled;\n\n    return true;\n  }\n\n  return false;\n};\n\n/**\n * @param {RTCPeerConnection} peerConnection\n * @param {Object} meetingProperties\n * @param {string} meetingProperties.meetingId\n * @param {string} meetingProperties.remoteQualityLevel LOW|MEDIUM|HIGH\n * @returns {Promise}\n */\nMedia.reconnectMedia = (\n  peerConnection: RTCPeerConnection,\n  {\n    meetingId,\n    remoteQualityLevel,\n    enableRtx,\n    enableExtmap,\n  }: {\n    meetingId: string;\n    remoteQualityLevel: string;\n    enableRtx: any;\n    enableExtmap: any;\n  }\n) => {\n  if (\n    peerConnection.connectionState === PEER_CONNECTION_STATE.CLOSED ||\n    peerConnection.connectionState === PEER_CONNECTION_STATE.FAILED\n  ) {\n    return Promise.reject(new ReconnectionError('Reinitiate peerconnection'));\n  }\n\n  return PeerConnectionManager.createOffer(peerConnection, {\n    meetingId,\n    remoteQualityLevel,\n    enableRtx,\n    enableExtmap,\n  });\n};\n\n/**\n * format the media array for send\n * @param {String} mediaId\n * @param {Boolean} audioMuted\n * @param {Boolean} videoMuted\n * @returns {Array} medias\n */\nMedia.generateLocalMedias = (mediaId: string, audioMuted: boolean, videoMuted: boolean) => {\n  if (mediaId) {\n    return [\n      {\n        localSdp: JSON.stringify({\n          audioMuted,\n          videoMuted,\n        }),\n        mediaId,\n      },\n    ];\n  }\n\n  return [];\n};\n\n/**\n * make a browser call to get the media\n * @param {SendOptions} options\n * @param {Object} config SDK Configuration for meetings plugin\n * @returns {Promise}\n */\nMedia.getLocalMedia = (options: any, config: object) => {\n  const {sendAudio, sendVideo, sendShare, sharePreferences, isSharing} = options;\n\n  if (sendAudio || sendVideo) {\n    return Media.getMedia(sendAudio, sendVideo, config);\n  }\n\n  if (sendShare && !isSharing) {\n    return Media.getDisplayMedia(\n      {\n        sendAudio: false,\n        sendShare: true,\n        sharePreferences,\n      },\n      config\n    );\n  }\n\n  return Promise.resolve(undefined);\n};\n/**\n * Returns the direction and tracks\n * @param {string} trackType type of track (audio/video)\n * @param {object}  track  tracks passed\n * @param {boolean} receiveTracks do you want to receive tracks from the remote side\n * @returns {Object} returns direction tracks to be added in transceiver\n */\nMedia.checkTracks = (trackType: string, track: object, receiveTracks: boolean) => {\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  const getDirection = (sendTracks, receiveTracks) => {\n    if (sendTracks && receiveTracks) {\n      return 'sendrecv';\n    }\n    if (sendTracks && !receiveTracks) {\n      return 'sendonly';\n    }\n    if (!sendTracks && receiveTracks) {\n      return 'recvonly';\n    }\n\n    return 'inactive';\n  };\n\n  if (track) {\n    return {track, direction: getDirection(!!track, receiveTracks)};\n  }\n\n  return {track: trackType, direction: getDirection(!!track, receiveTracks)};\n};\n/**\n * creates peerconnection and attaches streams\n * @param {MediaDirection} mediaProperties\n * @param {Object} meetingProperties\n * @param {string} meetingProperties.meetingId\n * @param {string} meetingProperties.remoteQualityLevel LOW|MEDIUM|HIGH\n * @returns {Array} [peerConnection, ]\n */\nMedia.attachMedia = (\n  mediaProperties: any,\n  {\n    meetingId,\n    remoteQualityLevel,\n    enableRtx,\n    enableExtmap,\n  }: {\n    meetingId: string;\n    remoteQualityLevel: string;\n    enableRtx: any;\n    enableExtmap: any;\n  }\n) => {\n  const {mediaDirection, audioTrack, videoTrack, shareTrack, peerConnection} = mediaProperties;\n\n  let result = null;\n\n  // Add Transceiver for audio\n  result = Media.checkTracks(\n    'audio',\n    mediaDirection.sendAudio && audioTrack,\n    mediaDirection.receiveAudio\n  );\n  peerConnection.audioTransceiver = peerConnection.addTransceiver(result.track, {\n    direction: result.direction,\n  });\n\n  // Add Transceiver for video\n  result = Media.checkTracks(\n    'video',\n    mediaDirection.sendVideo && videoTrack,\n    mediaDirection.receiveVideo\n  );\n  peerConnection.videoTransceiver = peerConnection.addTransceiver(result.track, {\n    direction: result.direction,\n  });\n\n  // Add Transceiver for share\n  result = Media.checkTracks(\n    'video',\n    mediaDirection.sendShare && shareTrack,\n    mediaDirection.receiveShare\n  );\n  peerConnection.shareTransceiver = peerConnection.addTransceiver(result.track, {\n    direction: result.direction,\n  });\n\n  peerConnection.onnegotiationneeded = (event) => {\n    LoggerProxy.logger.info(\n      `Media:index#attachMedia --> onnegotiationneeded#PeerConnection: ${event}`\n    );\n  };\n\n  return PeerConnectionManager.createOffer(peerConnection, {\n    meetingId,\n    remoteQualityLevel,\n    enableRtx,\n    enableExtmap,\n  });\n};\n\n/**\n * updates all the media streams and creates a new media offer\n * @param {MediaDirection} mediaProperties\n * @param {Object} meetingProperties\n * @param {string} meetingProperties.meetingId\n * @param {string} meetingProperties.remoteQualityLevel LOW|MEDIUM|HIGH\n * @returns {Promise}\n */\nMedia.updateMedia = (\n  mediaProperties: any,\n  {\n    meetingId,\n    remoteQualityLevel,\n    enableRtx,\n    enableExtmap,\n  }: {\n    meetingId: string;\n    remoteQualityLevel: string;\n    enableRtx: any;\n    enableExtmap: any;\n  }\n) => {\n  const {mediaDirection, audioTrack, videoTrack, shareTrack, peerConnection} = mediaProperties;\n\n  // update audio transceiver\n  Media.setTrackOnTransceiver(peerConnection.audioTransceiver, {\n    type: 'audio',\n    track: audioTrack,\n    sendTrack: mediaDirection.sendAudio && audioTrack,\n    receiveTrack: mediaDirection.receiveAudio,\n  });\n\n  // update video transceiver\n  Media.setTrackOnTransceiver(peerConnection.videoTransceiver, {\n    type: 'video',\n    track: videoTrack,\n    sendTrack: mediaDirection.sendVideo && videoTrack,\n    receiveTrack: mediaDirection.receiveVideo,\n  });\n\n  // update content transceiver\n  Media.setTrackOnTransceiver(peerConnection.shareTransceiver, {\n    type: 'video',\n    track: shareTrack,\n    sendTrack: mediaDirection.sendShare && shareTrack,\n    receiveTrack: mediaDirection.receiveShare,\n  });\n  peerConnection.onnegotiationneeded = (event) => {\n    LoggerProxy.logger.info(\n      `Media:index#updateMedia --> onnegotiationneeded#PeerConnection: ${event}`\n    );\n  };\n\n  return PeerConnectionManager.createOffer(peerConnection, {\n    meetingId,\n    remoteQualityLevel,\n    enableRtx,\n    enableExtmap,\n  });\n};\n\n/**\n * @param {RTCRtpTransceiver} transceiver\n * @param {Object} options\n * @param {MediaStreamTrack} options.track\n * @returns {undefined}\n */\nMedia.setTrackOnTransceiver = (\n  transceiver: RTCRtpTransceiver,\n  options: {\n    track: MediaStreamTrack;\n    type: any;\n    sendTrack: any;\n    receiveTrack: any;\n  }\n) => {\n  const {type, track, sendTrack, receiveTrack} = options;\n\n  try {\n    const result = Media.checkTracks(type, sendTrack && track, receiveTrack);\n\n    transceiver.direction = result.direction;\n    if (options.track) {\n      transceiver.sender.replaceTrack(track);\n    }\n  } catch (e) {\n    LoggerProxy.logger.error(`Media:index#setTrackOnTransceiver --> ${e}`);\n    throw e;\n  }\n};\n\n/**\n * creates a new offer\n * @param {Object} meetingProperties\n * @param {string} meetingProperties.meetingId\n * @param {string} meetingProperties.remoteQualityLevel LOW|MEDIUM|HIGH\n * @param {RTCPeerConnection} peerConnection\n * @param {RTCRtpTransceiver} transceiver\n * @param {Object} options see #Media.setTrackOnTransceiver\n * @returns {Promise}\n */\nMedia.updateTransceiver = (\n  {\n    meetingId,\n    remoteQualityLevel,\n    enableRtx,\n    enableExtmap,\n  }: {\n    meetingId: string;\n    remoteQualityLevel: string;\n    enableRtx: any;\n    enableExtmap: any;\n  },\n  peerConnection: RTCPeerConnection,\n  transceiver: RTCRtpTransceiver,\n  options: object\n) => {\n  Media.setTrackOnTransceiver(transceiver, options);\n\n  return PeerConnectionManager.createOffer(peerConnection, {\n    meetingId,\n    remoteQualityLevel,\n    enableRtx,\n    enableExtmap,\n  });\n};\n\n/**\n * generates share streams\n * @param {Object} options parameter\n * @param {Boolean} options.sendAudio send audio from the display share\n * @param {Boolean} options.sendShare send video from the display share\n * @param {Object} options.sharePreferences\n * @param {MediaTrackConstraints} options.sharePreferences.shareConstraints constraints to apply to video\n *   @see {@link https://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints}\n * @param {Boolean} options.sharePreferences.highFrameRate if shareConstraints isn't provided, set default values based off of this boolean\n * @param {Object} config SDK Configuration for meetings plugin\n * @returns {Promise.<MediaStream>}\n */\nMedia.getDisplayMedia = (\n  options: {\n    sendAudio: boolean;\n    sendShare: boolean;\n    sharePreferences: {\n      shareConstraints: MediaTrackConstraints;\n      highFrameRate: any;\n    };\n  },\n  config: any = {}\n) => {\n  // SDK screen share resolution settings from Webex.init\n  const customResolution = config.screenResolution || {};\n  // user defined screen share frame rate\n  const customShareFrameRate = config.screenFrameRate || null;\n  // user defined share preferences\n  const hasSharePreferences = options.sharePreferences;\n  const hasCustomConstraints = hasSharePreferences && hasSharePreferences.shareConstraints;\n  const hasHighFrameRate = hasSharePreferences && hasSharePreferences.highFrameRate;\n  const {screenResolution, resolution, videoShareFrameRate, screenFrameRate, aspectRatio} =\n    Config.meetings;\n\n  let shareConstraints: any = {\n    cursor: MEDIA_TRACK_CONSTRAINT.CURSOR.AWLAYS,\n    aspectRatio,\n  };\n\n  if (hasCustomConstraints) {\n    shareConstraints = hasSharePreferences.shareConstraints;\n  } else if (hasHighFrameRate) {\n    shareConstraints = {\n      ...shareConstraints,\n      frameRate: videoShareFrameRate,\n      height: resolution.idealHeight,\n      width: resolution.idealWidth,\n      ...config.resolution,\n    };\n  } else {\n    shareConstraints = {\n      ...shareConstraints,\n      frameRate: customShareFrameRate || screenFrameRate,\n      height: customResolution.idealHeight || screenResolution.idealHeight,\n      width: customResolution.idealWidth || screenResolution.idealWidth,\n      ...config.screenResolution,\n    };\n  }\n\n  // chrome and webkit based browsers (edge, safari) automatically adjust everything\n  // and we have noticed higher quality with those browser types\n  // firefox specifically has some issues with resolution and frame rate decision making\n  // so we are making it optional and configurable (with defaults) for firefox\n  // to have higher quality, and for developers to control the values\n  // eventually we may have to add the same functionality to chrome, OR conversely, get to with firefox\n\n  if (isBrowser('firefox')) {\n    const mediaConfig: any = {\n      audio: options.sendAudio,\n      video: options.sendShare,\n    };\n\n    return navigator.mediaDevices\n      .getDisplayMedia({audio: options.sendAudio, video: mediaConfig})\n      .then((stream) => {\n        if (options.sendShare && stream.getVideoTracks().length > 0) {\n          // Firefox has a bug with the spec where changing in the height and width only happens\n          // after we get the inital tracks\n          // https://bugzilla.mozilla.org/show_bug.cgi?id=1321221\n          stream.getVideoTracks()[0].applyConstraints(shareConstraints);\n        }\n\n        return stream;\n      });\n  }\n\n  const getDisplayMediaParams: any = {video: options.sendShare ? shareConstraints : false};\n\n  // safari doesn't support sending screen share audio\n  // https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia\n  if (options.sendAudio && isBrowser('safari')) {\n    getDisplayMediaParams.audio = options.sendAudio;\n  }\n\n  return navigator.mediaDevices.getDisplayMedia(getDisplayMediaParams);\n};\n\n/**\n * generates audio and video using constraints (often called after getSupportedDevices)\n * @param {Object|Boolean} audio gum constraints\n * @param {Object|Boolean} video gum constraints\n * @param {Object} config SDK Configuration for meetings plugin\n * @returns {Object} {streams}\n */\nMedia.getMedia = (audio: any | boolean, video: any | boolean, config: any) => {\n  const defaultWidth = {ideal: config.resolution.idealWidth, max: config.resolution.maxWidth};\n  const defaultHeight = {ideal: config.resolution.idealHeight, max: config.resolution.maxHeight};\n  const mediaConfig = {\n    audio,\n    // TODO: Remove temporary workaround once Firefox fixes low constraint issues\n    // eslint-disable-next-line no-nested-ternary\n    video: video\n      ? isBrowser('firefox') && video.width && video.width.max === 320\n        ? {\n            deviceId: video.deviceId ? video.deviceId : undefined,\n            width: 320,\n            height: 180,\n            frameRate: video.frameRate ? video.frameRate : undefined,\n            facingMode: video.facingMode ? video.facingMode : undefined,\n          }\n        : {\n            deviceId: video.deviceId ? video.deviceId : undefined,\n            width: video.width ? video.width : defaultWidth,\n            height: video.height ? video.height : defaultHeight,\n            frameRate: video.frameRate ? video.frameRate : undefined,\n            facingMode: video.facingMode ? video.facingMode : undefined,\n          }\n      : false,\n    fake: process.env.NODE_ENV === 'test', // Special case to get fake media for Firefox browser for testing\n  };\n\n  return navigator.mediaDevices.getUserMedia(mediaConfig).catch((err) => {\n    const logPath = 'Media:index#getMedia --> navigator.mediaDevices.getUserMedia';\n\n    LoggerProxy.logger.error(`${logPath} failed - ${err} (${err.constraint})`);\n    throw err;\n  });\n};\n\n/**\n * Checks if the machine has at least one audio or video device (Dont use this for screen share)\n * @param {object} [options]\n * {\n *    sendAudio: true/false,\n *    sendVideo: true/false\n * }\n * @returns {Object} {\n *    sendAudio: true/false,\n *    sendVideo: true/false\n *}\n */\nMedia.getSupportedDevice = ({sendAudio, sendVideo}: {sendAudio: boolean; sendVideo: boolean}) =>\n  Promise.resolve().then(() => {\n    if (!navigator.mediaDevices || navigator.mediaDevices.enumerateDevices === undefined) {\n      return {\n        sendAudio: false,\n        sendVideo: false,\n      };\n    }\n\n    return navigator.mediaDevices.enumerateDevices().then((devices) => {\n      const supported = {\n        audio: devices.filter((device) => device.kind === AUDIO_INPUT).length > 0,\n        video: devices.filter((device) => device.kind === VIDEO_INPUT).length > 0,\n      };\n\n      return {\n        sendAudio: supported.audio && sendAudio,\n        sendVideo: supported.video && sendVideo,\n      };\n    });\n  });\n\n/**\n * proxy to browser navigator.mediaDevices.enumerateDevices()\n * @returns {Promise}\n */\nMedia.getDevices = () => {\n  if (navigator && navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\n    return navigator.mediaDevices.enumerateDevices();\n  }\n\n  return Promise.reject(new MediaError('enumerateDevices not supported.'));\n};\n\n/**\n *\n * Toggle a specific stream\n * noop as of now, does nothing\n * @returns {null}\n */\nMedia.toggleStream = () => {};\n\n/**\n * Stop input stream\n * @param {MediaTrack} track A media stream\n * @returns {null}\n */\nMedia.stopTracks = (track: any) => {\n  if (!track) {\n    return Promise.resolve();\n  }\n\n  return Promise.resolve().then(() => {\n    if (track && track.stop) {\n      try {\n        track.stop();\n      } catch (e) {\n        LoggerProxy.logger.error(\n          `Media:index#stopTracks --> Unable to stop the track with state ${track.readyState}, error: ${e}`\n        );\n      }\n    }\n  });\n};\n\n/**\n *\n * Stop input stream\n * @param {Stream} stream A media stream\n * @returns {null}\n * @deprecated after v1.89.3\n */\nMedia.stopStream = (stream: any) => {\n  LoggerProxy.logger.warn(\n    'Media:index#stopStream --> [DEPRECATION WARNING]: stopStream has been deprecated after v1.89.3'\n  );\n  if (!stream) {\n    return Promise.resolve();\n  }\n\n  /*\n   * To release local media\n   * 1) Chrome requires all tracks to be stopped (stream.stop got deprecated)\n   * 2) Firefox requires the stream to be stopped\n   */\n  return Promise.resolve().then(() => {\n    if (stream.getTracks) {\n      stream.getTracks().forEach((track) => {\n        track.stop();\n      });\n    } else if (stream.stop) {\n      stream.stop();\n    }\n  });\n};\n\n/**\n * generates streams for audio video and share\n * @param {object} mediaSetting parameter\n * @param {Object} mediaSetting.sendAudio sendAudio: {Boolean} sendAudio constraints\n * @param {Object} mediaSetting.sendVideo sendVideo: {Boolean} sendVideo constraints\n * @param {Object} mediaSetting.sendShare sendShare: {Boolean} sendShare constraints\n * @param {Object} mediaSetting.isSharing isSharing: {Boolean} isSharing constraints\n * @param {Object} audioVideo parameter\n * @param {Object} audioVideo.audio {deviceId: {String}}\n * @param {Object} audioVideo.video {deviceId: {String}}\n * @param {Object} sharePreferences parameter\n * @param {Object} sharePreferences.shareConstraints parameter\n * @param {Boolean} sharePreferences.highFrameRate parameter\n * @param {Object} config SDK Config\n * @returns {Array} [localStream, shareStream]\n */\nMedia.getUserMedia = (\n  mediaSetting: {\n    sendAudio: object;\n    sendVideo: object;\n    sendShare: object;\n    isSharing: object;\n  },\n  audioVideo: {\n    audio: object;\n    video: object;\n  },\n  sharePreferences: {\n    shareConstraints: object;\n    highFrameRate: boolean;\n  },\n  config: object\n) =>\n  Media.getLocalMedia(\n    {\n      sendAudio: mediaSetting.sendAudio ? audioVideo.audio || mediaSetting.sendAudio : false,\n      sendVideo: mediaSetting.sendVideo ? audioVideo.video || mediaSetting.sendVideo : false,\n    },\n    config\n  ).then((localStream) =>\n    Media.getLocalMedia(\n      {\n        sendShare: mediaSetting.sendShare,\n        isSharing: mediaSetting.isSharing,\n        sharePreferences,\n      },\n      config\n    ).then((shareStream) => [localStream, shareStream])\n  );\n\nexport default Media;\n"],"mappings":"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"}