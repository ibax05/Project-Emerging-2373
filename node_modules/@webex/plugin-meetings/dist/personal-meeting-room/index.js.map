{"version":3,"names":["_webexCore","require","_constants","_parameter","_interopRequireDefault","_request","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf2","default","result","NewTarget","constructor","_Reflect$construct","arguments","apply","_possibleConstructorReturn2","Reflect","sham","Proxy","Boolean","prototype","valueOf","call","e","PersonalMeetingRoom","_StatelessWebexPlugin","_inherits2","_super","attrs","options","_this","_classCallCheck2","_defineProperty2","_assertThisInitialized2","MEETINGS","pmr","sipUri","link","userId","name","meetingInfo","personalMeetingRoomRequest","PersonalMeetingRoomRequest","_createClass2","key","value","claim","pin","_this2","preferred","length","undefined","webex","internal","device","passcode","meetingAddress","claimPmr","then","body","set","_promise","reject","ParameterError","sipMeetingUri","meetingLink","webExMeetingLink","owner","meetingName","number","meetingNumber","get","_this3","type","_PERSONAL_ROOM_","fetchMeetingInfo","isPmr","TypeError","StatelessWebexPlugin","exports"],"sources":["index.ts"],"sourcesContent":["// @ts-ignore\nimport {StatelessWebexPlugin} from '@webex/webex-core';\n\nimport {MEETINGS, _PERSONAL_ROOM_} from '../constants';\nimport ParameterError from '../common/errors/parameter';\n\nimport PersonalMeetingRoomRequest from './request';\n\n/**\n * @class PersonalMeetingRoom\n */\nexport default class PersonalMeetingRoom extends StatelessWebexPlugin {\n  link: any;\n  meetingInfo: any;\n  name: any;\n  personalMeetingRoomRequest: any;\n  pmr: any;\n  sipUri: any;\n  userId: any;\n  meetingLink: any;\n  number: any;\n\n  namespace = MEETINGS;\n\n  /**\n   *\n   * @param {Object} attrs\n   * @param {Object} options\n   */\n  constructor(attrs: any, options: any) {\n    super({}, options);\n    /**\n     * The pmr server object\n     * @instance\n     * @type {Object}\n     * @public\n     * @memberof PersonalMeetingRoom\n     */\n    this.pmr = null;\n    /**\n     * The pmr sip Uri\n     * @instance\n     * @type {String}\n     * @public\n     * @memberof PersonalMeetingRoom\n     */\n    this.sipUri = null;\n    /**\n     * The pmr link\n     * @instance\n     * @type {String}\n     * @public\n     * @memberof PersonalMeetingRoom\n     */\n    this.link = null;\n    /**\n     * The pmr server object\n     * @instance\n     * @type {Object}\n     * @public\n     * @memberof PersonalMeetingRoom\n     */\n    this.userId = null;\n    /**\n     * The pmr name\n     * @instance\n     * @type {String}\n     * @public\n     * @memberof PersonalMeetingRoom\n     */\n    this.name = null;\n    /**\n     * The meeting info request server interface\n     * @instance\n     * @type {MeetingInfo}\n     * @private\n     * @memberof PersonalMeetingRoom\n     */\n    this.meetingInfo = attrs.meetingInfo;\n    /**\n     * The pmr server request interface\n     * @instance\n     * @type {Object}\n     * @private\n     * @memberof PersonalMeetingRoom\n     */\n    // @ts-ignore\n    this.personalMeetingRoomRequest = new PersonalMeetingRoomRequest({}, options);\n  }\n\n  /**\n   * claims a pmr and updates the cached PMR values\n   * @param {String} link\n   * @param {String} pin\n   * @param {Boolean} [preferred] defaults to true to set this claimed PMR as the preferred\n   * @returns {Promise}\n   * @public\n   * @memberof PersonalMeetingRoom\n   */\n  public claim(link: string, pin: string, preferred = true) {\n    const options = {\n      // @ts-ignore\n      userId: this.webex.internal.device.userId,\n      passcode: pin,\n      meetingAddress: link,\n      preferred,\n    };\n\n    return this.personalMeetingRoomRequest.claimPmr(options).then((pmr) => {\n      if (pmr && pmr.body) {\n        this.set(pmr.body);\n      } else {\n        return Promise.reject(new ParameterError('No PMR body provided. PMR values not updated.'));\n      }\n\n      return pmr.body;\n    });\n  }\n\n  /**\n   * @param {Object} body the response body from meeting info request\n   * @returns {undefined}\n   * @private\n   * @memberof PersonalMeetingRoom\n   */\n  private set(body: any) {\n    this.pmr = body;\n    this.sipUri = body.sipMeetingUri;\n    this.meetingLink = body.webExMeetingLink || body.meetingLink;\n    this.userId = body.owner;\n    this.name = body.meetingName;\n    this.number = body.meetingNumber;\n  }\n\n  /**\n   * TODO: implement TTL for syncing and caching so to not request again and again\n   * @param {Object} options\n   * @returns {Promise}\n   * @public\n   * @memberof PersonalMeetingRoom\n   */\n  public get() {\n    const options = {\n      type: _PERSONAL_ROOM_,\n    };\n\n    return this.meetingInfo.fetchMeetingInfo(options).then((pmr) => {\n      if (pmr && pmr.body && pmr.body.isPmr) {\n        this.set(pmr.body);\n      } else {\n        return Promise.reject(new TypeError('The PMR requested is NOT a PMR. PMR values not set.'));\n      }\n\n      return pmr.body;\n    });\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;AACA,IAAAA,UAAA,GAAAC,OAAA;AAEA,IAAAC,UAAA,GAAAD,OAAA;AACA,IAAAE,UAAA,GAAAC,sBAAA,CAAAH,OAAA;AAEA,IAAAI,QAAA,GAAAD,sBAAA,CAAAH,OAAA;AAAmD,SAAAK,aAAAC,OAAA,QAAAC,yBAAA,GAAAC,yBAAA,oBAAAC,qBAAA,QAAAC,KAAA,OAAAC,gBAAA,CAAAC,OAAA,EAAAN,OAAA,GAAAO,MAAA,MAAAN,yBAAA,QAAAO,SAAA,OAAAH,gBAAA,CAAAC,OAAA,QAAAG,WAAA,EAAAF,MAAA,GAAAG,kBAAA,CAAAN,KAAA,EAAAO,SAAA,EAAAH,SAAA,YAAAD,MAAA,GAAAH,KAAA,CAAAQ,KAAA,OAAAD,SAAA,gBAAAE,2BAAA,CAAAP,OAAA,QAAAC,MAAA;AAAA,SAAAL,0BAAA,eAAAY,OAAA,qBAAAJ,kBAAA,oBAAAA,kBAAA,CAAAK,IAAA,2BAAAC,KAAA,oCAAAC,OAAA,CAAAC,SAAA,CAAAC,OAAA,CAAAC,IAAA,CAAAV,kBAAA,CAAAO,OAAA,8CAAAI,CAAA;AAEnD;AACA;AACA;AAFA,IAGqBC,mBAAmB,0BAAAC,qBAAA;EAAA,IAAAC,UAAA,CAAAlB,OAAA,EAAAgB,mBAAA,EAAAC,qBAAA;EAAA,IAAAE,MAAA,GAAA1B,YAAA,CAAAuB,mBAAA;EAatC;AACF;AACA;AACA;AACA;EACE,SAAAA,oBAAYI,KAAU,EAAEC,OAAY,EAAE;IAAA,IAAAC,KAAA;IAAA,IAAAC,gBAAA,CAAAvB,OAAA,QAAAgB,mBAAA;IACpCM,KAAA,GAAAH,MAAA,CAAAL,IAAA,OAAM,CAAC,CAAC,EAAEO,OAAO;IACjB;AACJ;AACA;AACA;AACA;AACA;AACA;IANI,IAAAG,gBAAA,CAAAxB,OAAA,MAAAyB,uBAAA,CAAAzB,OAAA,EAAAsB,KAAA;IAAA,IAAAE,gBAAA,CAAAxB,OAAA,MAAAyB,uBAAA,CAAAzB,OAAA,EAAAsB,KAAA;IAAA,IAAAE,gBAAA,CAAAxB,OAAA,MAAAyB,uBAAA,CAAAzB,OAAA,EAAAsB,KAAA;IAAA,IAAAE,gBAAA,CAAAxB,OAAA,MAAAyB,uBAAA,CAAAzB,OAAA,EAAAsB,KAAA;IAAA,IAAAE,gBAAA,CAAAxB,OAAA,MAAAyB,uBAAA,CAAAzB,OAAA,EAAAsB,KAAA;IAAA,IAAAE,gBAAA,CAAAxB,OAAA,MAAAyB,uBAAA,CAAAzB,OAAA,EAAAsB,KAAA;IAAA,IAAAE,gBAAA,CAAAxB,OAAA,MAAAyB,uBAAA,CAAAzB,OAAA,EAAAsB,KAAA;IAAA,IAAAE,gBAAA,CAAAxB,OAAA,MAAAyB,uBAAA,CAAAzB,OAAA,EAAAsB,KAAA;IAAA,IAAAE,gBAAA,CAAAxB,OAAA,MAAAyB,uBAAA,CAAAzB,OAAA,EAAAsB,KAAA;IAAA,IAAAE,gBAAA,CAAAxB,OAAA,MAAAyB,uBAAA,CAAAzB,OAAA,EAAAsB,KAAA,gBATUI,mBAAQ;IAgBlBJ,KAAA,CAAKK,GAAG,GAAG,IAAI;IACf;AACJ;AACA;AACA;AACA;AACA;AACA;IACIL,KAAA,CAAKM,MAAM,GAAG,IAAI;IAClB;AACJ;AACA;AACA;AACA;AACA;AACA;IACIN,KAAA,CAAKO,IAAI,GAAG,IAAI;IAChB;AACJ;AACA;AACA;AACA;AACA;AACA;IACIP,KAAA,CAAKQ,MAAM,GAAG,IAAI;IAClB;AACJ;AACA;AACA;AACA;AACA;AACA;IACIR,KAAA,CAAKS,IAAI,GAAG,IAAI;IAChB;AACJ;AACA;AACA;AACA;AACA;AACA;IACIT,KAAA,CAAKU,WAAW,GAAGZ,KAAK,CAACY,WAAW;IACpC;AACJ;AACA;AACA;AACA;AACA;AACA;IACI;IACAV,KAAA,CAAKW,0BAA0B,GAAG,IAAIC,gBAA0B,CAAC,CAAC,CAAC,EAAEb,OAAO,CAAC;IAAC,OAAAC,KAAA;EAChF;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EARE,IAAAa,aAAA,CAAAnC,OAAA,EAAAgB,mBAAA;IAAAoB,GAAA;IAAAC,KAAA,EASA,SAAAC,MAAaT,IAAY,EAAEU,GAAW,EAAoB;MAAA,IAAAC,MAAA;MAAA,IAAlBC,SAAS,GAAApC,SAAA,CAAAqC,MAAA,QAAArC,SAAA,QAAAsC,SAAA,GAAAtC,SAAA,MAAG,IAAI;MACtD,IAAMgB,OAAO,GAAG;QACd;QACAS,MAAM,EAAE,IAAI,CAACc,KAAK,CAACC,QAAQ,CAACC,MAAM,CAAChB,MAAM;QACzCiB,QAAQ,EAAER,GAAG;QACbS,cAAc,EAAEnB,IAAI;QACpBY,SAAS,EAATA;MACF,CAAC;MAED,OAAO,IAAI,CAACR,0BAA0B,CAACgB,QAAQ,CAAC5B,OAAO,CAAC,CAAC6B,IAAI,CAAC,UAACvB,GAAG,EAAK;QACrE,IAAIA,GAAG,IAAIA,GAAG,CAACwB,IAAI,EAAE;UACnBX,MAAI,CAACY,GAAG,CAACzB,GAAG,CAACwB,IAAI,CAAC;QACpB,CAAC,MAAM;UACL,OAAOE,QAAA,CAAArD,OAAA,CAAQsD,MAAM,CAAC,IAAIC,kBAAc,CAAC,+CAA+C,CAAC,CAAC;QAC5F;QAEA,OAAO5B,GAAG,CAACwB,IAAI;MACjB,CAAC,CAAC;IACJ;;IAEA;AACF;AACA;AACA;AACA;AACA;EALE;IAAAf,GAAA;IAAAC,KAAA,EAMA,SAAAe,IAAYD,IAAS,EAAE;MACrB,IAAI,CAACxB,GAAG,GAAGwB,IAAI;MACf,IAAI,CAACvB,MAAM,GAAGuB,IAAI,CAACK,aAAa;MAChC,IAAI,CAACC,WAAW,GAAGN,IAAI,CAACO,gBAAgB,IAAIP,IAAI,CAACM,WAAW;MAC5D,IAAI,CAAC3B,MAAM,GAAGqB,IAAI,CAACQ,KAAK;MACxB,IAAI,CAAC5B,IAAI,GAAGoB,IAAI,CAACS,WAAW;MAC5B,IAAI,CAACC,MAAM,GAAGV,IAAI,CAACW,aAAa;IAClC;;IAEA;AACF;AACA;AACA;AACA;AACA;AACA;EANE;IAAA1B,GAAA;IAAAC,KAAA,EAOA,SAAA0B,IAAA,EAAa;MAAA,IAAAC,MAAA;MACX,IAAM3C,OAAO,GAAG;QACd4C,IAAI,EAAEC;MACR,CAAC;MAED,OAAO,IAAI,CAAClC,WAAW,CAACmC,gBAAgB,CAAC9C,OAAO,CAAC,CAAC6B,IAAI,CAAC,UAACvB,GAAG,EAAK;QAC9D,IAAIA,GAAG,IAAIA,GAAG,CAACwB,IAAI,IAAIxB,GAAG,CAACwB,IAAI,CAACiB,KAAK,EAAE;UACrCJ,MAAI,CAACZ,GAAG,CAACzB,GAAG,CAACwB,IAAI,CAAC;QACpB,CAAC,MAAM;UACL,OAAOE,QAAA,CAAArD,OAAA,CAAQsD,MAAM,CAAC,IAAIe,SAAS,CAAC,qDAAqD,CAAC,CAAC;QAC7F;QAEA,OAAO1C,GAAG,CAACwB,IAAI;MACjB,CAAC,CAAC;IACJ;EAAC;EAAA,OAAAnC,mBAAA;AAAA,EAhJ8CsD,+BAAoB;AAAAC,OAAA,CAAAvE,OAAA,GAAAgB,mBAAA"}