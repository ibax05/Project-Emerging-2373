{"version":3,"names":["_httpCore","require","_mime","detectFileType","file","logger","type","info","concat","_promise","default","resolve","mimeType","detect","then","getType","name"],"sources":["detect-filetype.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {detect} from '@webex/http-core';\nimport {getType} from 'mime';\n\n/**\n * Determines the file type of the specified file\n * @param {FileLike} file\n * @param {Object} logger\n * @returns {Promise<string>}\n */\nexport default function detectFileType(file, logger) {\n  if (file.type) {\n    logger.info(`file already has type ${file.type}. using existing file.type.`);\n\n    return Promise.resolve(file.type);\n  }\n\n  if (file.mimeType) {\n    logger.info(`file already has mimeType ${file.type}. using existing file.mimeType.`);\n\n    return Promise.resolve(file.mimeType);\n  }\n\n  // This kinda belongs in http core, but since we have no guarantee that\n  // buffers are expected to have names there, it'll stay here for now.\n  return detect(file).then((type) => {\n    if (type === 'application/x-msi' || type === 'application/octet-stream') {\n      logger.info(`detected filetype to be ${type}. Falling back to mime.lookup`);\n\n      return getType(file.name);\n    }\n\n    logger.info(`detected filetype to be ${type}. returning it`);\n\n    return type;\n  });\n}\n"],"mappings":";;;;;;;;;AAIA,IAAAA,SAAA,GAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AALA;AACA;AACA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACe,SAASE,cAAcA,CAACC,IAAI,EAAEC,MAAM,EAAE;EACnD,IAAID,IAAI,CAACE,IAAI,EAAE;IACbD,MAAM,CAACE,IAAI,0BAAAC,MAAA,CAA0BJ,IAAI,CAACE,IAAI,iCAA8B;IAE5E,OAAOG,QAAA,CAAAC,OAAA,CAAQC,OAAO,CAACP,IAAI,CAACE,IAAI,CAAC;EACnC;EAEA,IAAIF,IAAI,CAACQ,QAAQ,EAAE;IACjBP,MAAM,CAACE,IAAI,8BAAAC,MAAA,CAA8BJ,IAAI,CAACE,IAAI,qCAAkC;IAEpF,OAAOG,QAAA,CAAAC,OAAA,CAAQC,OAAO,CAACP,IAAI,CAACQ,QAAQ,CAAC;EACvC;;EAEA;EACA;EACA,OAAO,IAAAC,gBAAM,EAACT,IAAI,CAAC,CAACU,IAAI,CAAC,UAACR,IAAI,EAAK;IACjC,IAAIA,IAAI,KAAK,mBAAmB,IAAIA,IAAI,KAAK,0BAA0B,EAAE;MACvED,MAAM,CAACE,IAAI,4BAAAC,MAAA,CAA4BF,IAAI,mCAAgC;MAE3E,OAAO,IAAAS,aAAO,EAACX,IAAI,CAACY,IAAI,CAAC;IAC3B;IAEAX,MAAM,CAACE,IAAI,4BAAAC,MAAA,CAA4BF,IAAI,oBAAiB;IAE5D,OAAOA,IAAI;EACb,CAAC,CAAC;AACJ"}