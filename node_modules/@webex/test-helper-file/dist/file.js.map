{"version":3,"names":["_fs","require","_path","_fileType","_common","ownKeys","object","enumerableOnly","keys","_Object$keys","_Object$getOwnPropertySymbols","symbols","filter","sym","_Object$getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","Object","forEach","key","_defineProperty2","default","_Object$getOwnPropertyDescriptors","_Object$defineProperties","_Object$defineProperty","fetchWithoutMagic","filename","_promise","resolve","reject","filepath","join","__dirname","readFile","err","data","name","exports","fetch","then","all","fromFile","_ref","_ref2","_slicedToArray2","type","mime","Error","isBufferLike","file","isBuffer","isBlobLike","isMatchingFile","left","right","equals"],"sources":["file.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {readFile} from 'fs';\nimport {join} from 'path';\n\nimport {fromFile} from 'file-type';\nimport {isBuffer} from '@webex/common';\n\nexport const fetchWithoutMagic = (filename) =>\n  new Promise((resolve, reject) => {\n    const filepath = join(__dirname, '../../../@webex/test-helper-server/static', filename);\n\n    readFile(filepath, (err, data) => {\n      if (err) {\n        reject(err);\n\n        return;\n      }\n      resolve({...data, name: filename});\n    });\n  });\n\nexport const fetch = (filename) =>\n  fetchWithoutMagic(filename)\n    .then((data) => Promise.all([fromFile(data), data]))\n    // .then(([{mime: type}, data]) => {\n    //   console.error(data, type);\n\n    //   return {...data, type};\n    // });\n    .then(([{mime: type}, data]) =>\n      type ? {...data, type} : Promise.reject(new Error('Invalid Media Type'))\n    );\n\nexport const isBufferLike = (file) => isBuffer(file);\n\nexport const isBlobLike = (file) => isBuffer(file);\n\nexport const isMatchingFile = (left, right) => {\n  if (!isBufferLike(left)) {\n    throw new Error('`left` must be a `Buffer`');\n  }\n\n  if (!isBufferLike(right)) {\n    throw new Error('`right` must be a `Buffer`');\n  }\n\n  // Node 10 doesn't have Buffer#equals()\n  if (left.equals) {\n    return Promise.resolve(left.equals(right));\n  }\n\n  if (left.length !== right.length) {\n    return Promise.resolve(false);\n  }\n\n  for (let i = 0; i < left.length; i += 1) {\n    if (left[i] !== right[i]) {\n      return Promise.resolve(false);\n    }\n  }\n\n  return Promise.resolve(true);\n};\n"],"mappings":"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"}